{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "feedback-sweep-corner",
  "type": "registry:ui",
  "title": "Feedback Sweep Corner",
  "description": "Feedback card with a corner vote badge and sweep animation effect on click.",
  "dependencies": [
    "motion",
    "@phosphor-icons/react",
    "clsx",
    "tailwind-merge"
  ],
  "registryDependencies": [],
  "files": [
    {
      "path": "ui/feedback-sweep-corner.tsx",
      "content": "\"use client\";\n\nimport { CaretDown, CaretUp, Chat } from \"@phosphor-icons/react\";\nimport { AnimatePresence, motion } from \"motion/react\";\nimport type { ReactNode } from \"react\";\nimport {\n  createContext,\n  useCallback,\n  useContext,\n  useMemo,\n  useState,\n} from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\n// ─── Types ──────────────────────────────────────────────────────────────────\n\ntype VoteType = \"upvote\" | \"downvote\" | null;\n\ninterface VoteState {\n  voteType: VoteType;\n  upvotes: number;\n  downvotes: number;\n  vote: (type: \"upvote\" | \"downvote\") => void;\n}\n\ninterface SweepCornerContextValue extends VoteState {}\n\n// ─── Tag Color Map ──────────────────────────────────────────────────────────\n\nconst TAG_COLORS: Record<string, string> = {\n  purple:\n    \"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400\",\n  green: \"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400\",\n  blue: \"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400\",\n  red: \"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400\",\n  amber: \"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400\",\n  pink: \"bg-pink-100 text-pink-700 dark:bg-pink-900/30 dark:text-pink-400\",\n  gray: \"bg-gray-100 text-gray-600 dark:bg-gray-800/30 dark:text-gray-400\",\n};\n\n// ─── Context ────────────────────────────────────────────────────────────────\n\nconst SweepCornerContext = createContext<SweepCornerContextValue | null>(null);\n\nfunction useSweepCornerContext(): SweepCornerContextValue {\n  const context = useContext(SweepCornerContext);\n  if (!context) {\n    throw new Error(\n      \"SweepCorner sub-components must be used within a <SweepCorner> provider.\"\n    );\n  }\n  return context;\n}\n\n// ─── Vote Hook ──────────────────────────────────────────────────────────────\n\nfunction useVoteState(\n  initialUp: number,\n  initialDown: number,\n  onVoteChange?: (voteType: VoteType) => void\n): VoteState {\n  const [voteType, setVoteType] = useState<VoteType>(null);\n  const [upvotes, setUpvotes] = useState(initialUp);\n  const [downvotes, setDownvotes] = useState(initialDown);\n\n  const vote = useCallback(\n    (type: \"upvote\" | \"downvote\") => {\n      let nextVoteType: VoteType;\n\n      if (voteType === type) {\n        nextVoteType = null;\n        if (type === \"upvote\") {\n          setUpvotes((v) => v - 1);\n        } else {\n          setDownvotes((v) => v - 1);\n        }\n      } else {\n        if (voteType === \"upvote\") {\n          setUpvotes((v) => v - 1);\n        }\n        if (voteType === \"downvote\") {\n          setDownvotes((v) => v - 1);\n        }\n        nextVoteType = type;\n        if (type === \"upvote\") {\n          setUpvotes((v) => v + 1);\n        } else {\n          setDownvotes((v) => v + 1);\n        }\n      }\n\n      setVoteType(nextVoteType);\n      onVoteChange?.(nextVoteType);\n    },\n    [voteType, onVoteChange]\n  );\n\n  return { voteType, upvotes, downvotes, vote };\n}\n\n// ─── Animated Count Helper ──────────────────────────────────────────────────\n\nfunction AnimatedCount({\n  value,\n  className,\n}: {\n  value: number;\n  className?: string;\n}) {\n  return (\n    <AnimatePresence mode=\"popLayout\">\n      <motion.span\n        animate={{ y: 0, opacity: 1 }}\n        className={cn(\"tabular-nums\", className)}\n        exit={{ y: -6, opacity: 0 }}\n        initial={{ y: 6, opacity: 0 }}\n        key={value}\n        transition={{ type: \"spring\", stiffness: 400, damping: 20 }}\n      >\n        {value}\n      </motion.span>\n    </AnimatePresence>\n  );\n}\n\n// ─── SweepCorner (Root Provider) ────────────────────────────────────────────\n\ninterface SweepCornerProps {\n  defaultUpvotes?: number;\n  defaultDownvotes?: number;\n  onVoteChange?: (voteType: VoteType) => void;\n  upvotes?: number;\n  downvotes?: number;\n  voteType?: VoteType;\n  onVote?: (direction: \"upvote\" | \"downvote\") => void;\n  children: ReactNode;\n  className?: string;\n}\n\nfunction SweepCorner({\n  defaultUpvotes = 0,\n  defaultDownvotes = 0,\n  onVoteChange,\n  upvotes: controlledUpvotes,\n  downvotes: controlledDownvotes,\n  voteType: controlledVoteType,\n  onVote,\n  children,\n  className,\n}: SweepCornerProps) {\n  const internalState = useVoteState(\n    defaultUpvotes,\n    defaultDownvotes,\n    onVoteChange\n  );\n\n  const isControlled = controlledUpvotes !== undefined;\n\n  const controlledState = useMemo<SweepCornerContextValue>(\n    () => ({\n      upvotes: controlledUpvotes ?? 0,\n      downvotes: controlledDownvotes ?? 0,\n      voteType: controlledVoteType ?? null,\n      vote: (type) => onVote?.(type),\n    }),\n    [controlledUpvotes, controlledDownvotes, controlledVoteType, onVote]\n  );\n\n  const contextValue = isControlled ? controlledState : internalState;\n\n  return (\n    <SweepCornerContext.Provider value={contextValue}>\n      <div className={cn(\"relative\", className)}>{children}</div>\n    </SweepCornerContext.Provider>\n  );\n}\n\n// ─── SweepCornerCard ────────────────────────────────────────────────────────\n\ninterface SweepCornerCardProps {\n  children: ReactNode;\n  className?: string;\n}\n\nfunction SweepCornerCard({ children, className }: SweepCornerCardProps) {\n  return (\n    <div\n      className={cn(\n        \"rounded-xl border border-border/50 bg-card transition-all hover:border-border hover:shadow-sm\",\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n\n// ─── SweepCornerContent ─────────────────────────────────────────────────────\n\ninterface SweepCornerContentProps {\n  children: ReactNode;\n  className?: string;\n}\n\nfunction SweepCornerContent({ children, className }: SweepCornerContentProps) {\n  return (\n    <div className={cn(\"space-y-3 px-4 pt-4 pr-20\", className)}>{children}</div>\n  );\n}\n\n// ─── SweepCornerTitle ───────────────────────────────────────────────────────\n\ninterface SweepCornerTitleProps {\n  children: ReactNode;\n  className?: string;\n}\n\nfunction SweepCornerTitle({ children, className }: SweepCornerTitleProps) {\n  return (\n    <h3 className={cn(\"font-medium text-sm leading-snug\", className)}>\n      {children}\n    </h3>\n  );\n}\n\n// ─── SweepCornerTags ────────────────────────────────────────────────────────\n\ninterface SweepCornerTagsProps {\n  children: ReactNode;\n  className?: string;\n}\n\nfunction SweepCornerTags({ children, className }: SweepCornerTagsProps) {\n  return (\n    <div className={cn(\"flex flex-wrap gap-1\", className)}>{children}</div>\n  );\n}\n\n// ─── SweepCornerTag ─────────────────────────────────────────────────────────\n\ninterface SweepCornerTagProps {\n  children: ReactNode;\n  color: string;\n  className?: string;\n}\n\nfunction SweepCornerTag({ children, color, className }: SweepCornerTagProps) {\n  const colorClasses =\n    TAG_COLORS[color] ?? \"bg-secondary text-secondary-foreground\";\n\n  return (\n    <span\n      className={cn(\n        \"inline-flex items-center rounded-sm px-2 py-0.5 font-normal text-[10px]\",\n        colorClasses,\n        className\n      )}\n    >\n      {children}\n    </span>\n  );\n}\n\n// ─── SweepCornerBadge ───────────────────────────────────────────────────────\n\nfunction SweepCornerBadge() {\n  const { voteType, upvotes, downvotes, vote } = useSweepCornerContext();\n  const net = upvotes - downvotes;\n\n  return (\n    <motion.div\n      animate={{\n        borderRadius: voteType ? \"0 12px 0 16px\" : \"0 12px 0 12px\",\n      }}\n      className=\"absolute top-0 right-0 flex items-center gap-0 overflow-hidden border-border/30 border-b border-l bg-card shadow-sm\"\n      transition={{ type: \"spring\", stiffness: 300, damping: 20 }}\n    >\n      <motion.button\n        animate={{\n          backgroundColor:\n            voteType === \"upvote\" ? \"var(--color-primary)\" : \"transparent\",\n        }}\n        aria-label={voteType === \"upvote\" ? \"Remove upvote\" : \"Upvote\"}\n        className={cn(\n          \"relative cursor-pointer px-2.5 py-2 text-xs transition-colors\",\n          voteType === \"upvote\"\n            ? \"text-primary-foreground\"\n            : \"text-muted-foreground hover:bg-muted hover:text-foreground\"\n        )}\n        onClick={(e) => {\n          e.stopPropagation();\n          vote(\"upvote\");\n        }}\n        type=\"button\"\n        whileTap={{ scale: 0.85 }}\n      >\n        <CaretUp\n          className=\"h-3.5 w-3.5\"\n          weight={voteType === \"upvote\" ? \"bold\" : \"regular\"}\n        />\n      </motion.button>\n\n      <AnimatedCount\n        className={cn(\n          \"px-2 py-1.5 font-bold text-xs\",\n          voteType === \"upvote\" && \"text-primary\",\n          voteType === \"downvote\" && \"text-destructive\",\n          !voteType && \"text-foreground\"\n        )}\n        value={net}\n      />\n\n      <motion.button\n        animate={{\n          backgroundColor:\n            voteType === \"downvote\"\n              ? \"var(--color-destructive)\"\n              : \"transparent\",\n        }}\n        aria-label={voteType === \"downvote\" ? \"Remove downvote\" : \"Downvote\"}\n        className={cn(\n          \"relative cursor-pointer px-2.5 py-2 text-xs transition-colors\",\n          voteType === \"downvote\"\n            ? \"text-destructive-foreground\"\n            : \"text-muted-foreground hover:bg-muted hover:text-foreground\"\n        )}\n        onClick={(e) => {\n          e.stopPropagation();\n          vote(\"downvote\");\n        }}\n        type=\"button\"\n        whileTap={{ scale: 0.85 }}\n      >\n        <CaretDown\n          className=\"h-3.5 w-3.5\"\n          weight={voteType === \"downvote\" ? \"bold\" : \"regular\"}\n        />\n      </motion.button>\n    </motion.div>\n  );\n}\n\n// ─── SweepCornerFooter ──────────────────────────────────────────────────────\n\ninterface SweepCornerFooterProps {\n  comments: number;\n  time: string;\n  className?: string;\n}\n\nfunction SweepCornerFooter({\n  comments,\n  time,\n  className,\n}: SweepCornerFooterProps) {\n  const { voteType, upvotes, downvotes } = useSweepCornerContext();\n  const total = upvotes + downvotes;\n  const upPercent = total > 0 ? Math.round((upvotes / total) * 100) : 50;\n\n  return (\n    <div\n      className={cn(\n        \"relative mt-3 overflow-hidden border-border/30 border-t\",\n        className\n      )}\n    >\n      <AnimatePresence>\n        {voteType && (\n          <motion.div\n            animate={{ x: \"100%\", opacity: 0 }}\n            className={cn(\n              \"absolute inset-0\",\n              voteType === \"upvote\"\n                ? \"bg-gradient-to-r from-transparent via-primary/12 to-transparent\"\n                : \"bg-gradient-to-r from-transparent via-destructive/12 to-transparent\"\n            )}\n            exit={{ opacity: 0 }}\n            initial={{ x: \"-100%\", opacity: 1 }}\n            key={voteType}\n            transition={{ duration: 0.6, ease: \"easeOut\" }}\n          />\n        )}\n      </AnimatePresence>\n\n      <div className=\"relative flex items-center gap-2 px-4 py-2\">\n        <div className=\"flex items-center gap-3 text-[11px] text-muted-foreground\">\n          <span className=\"flex items-center gap-1\">\n            <Chat className=\"h-3 w-3\" />\n            {comments}\n          </span>\n          <span className=\"opacity-70\">{time}</span>\n        </div>\n        <span className=\"text-[9px] text-muted-foreground/30 tabular-nums\">\n          {upvotes}↑ {downvotes}↓\n        </span>\n        <span className=\"text-[9px] text-muted-foreground/30 tabular-nums\">\n          {upPercent}%\n        </span>\n      </div>\n    </div>\n  );\n}\n\n// ─── Exports ────────────────────────────────────────────────────────────────\n\nexport {\n  SweepCorner,\n  SweepCornerCard,\n  SweepCornerContent,\n  SweepCornerTitle,\n  SweepCornerTags,\n  SweepCornerTag,\n  SweepCornerBadge,\n  SweepCornerFooter,\n};\n",
      "type": "registry:ui",
      "target": "components/ui/feedback-sweep-corner.tsx"
    }
  ],
  "meta": {
    "importSpecifier": "@/components/ui/feedback-sweep-corner"
  }
}