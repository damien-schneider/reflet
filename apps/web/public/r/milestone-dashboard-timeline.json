{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "milestone-dashboard-timeline",
  "type": "registry:ui",
  "title": "Milestone Dashboard Timeline",
  "description": "KPI summary bar at top with vertical timeline and sweep animation.",
  "dependencies": [
    "motion",
    "clsx",
    "tailwind-merge"
  ],
  "registryDependencies": [],
  "files": [
    {
      "path": "ui/milestone-dashboard-timeline.tsx",
      "content": "\"use client\";\n\nimport { AnimatePresence, motion } from \"motion/react\";\nimport { useState } from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nexport interface Milestone {\n  id: string;\n  name: string;\n  emoji: string;\n  colorHex: string;\n  horizonLabel: string;\n  horizonShort: string;\n  targetDate: string | null;\n  progress: {\n    total: number;\n    completed: number;\n    inProgress: number;\n    percentage: number;\n  };\n}\n\nexport interface MilestoneDashboardTimelineProps {\n  milestones: Milestone[];\n  className?: string;\n}\n\nfunction MultiSegmentBar({\n  completed,\n  inProgress,\n  total,\n}: {\n  completed: number;\n  inProgress: number;\n  total: number;\n}) {\n  const completedPct = (completed / Math.max(total, 1)) * 100;\n  const inProgressPct = (inProgress / Math.max(total, 1)) * 100;\n  return (\n    <div className=\"flex h-[3px] w-20 overflow-hidden rounded-full bg-muted/30\">\n      <motion.div\n        animate={{ width: `${completedPct}%` }}\n        className=\"h-full bg-emerald-500\"\n        initial={{ width: 0 }}\n        transition={{ type: \"spring\", stiffness: 200, damping: 30 }}\n      />\n      <motion.div\n        animate={{ width: `${inProgressPct}%` }}\n        className=\"h-full bg-primary\"\n        initial={{ width: 0 }}\n        transition={{\n          type: \"spring\",\n          stiffness: 200,\n          damping: 30,\n          delay: 0.05,\n        }}\n      />\n    </div>\n  );\n}\n\nfunction ProgressRing({\n  percentage,\n  size = 36,\n  strokeWidth = 3,\n  color,\n}: {\n  percentage: number;\n  size?: number;\n  strokeWidth?: number;\n  color: string;\n}) {\n  const radius = (size - strokeWidth) / 2;\n  const circumference = 2 * Math.PI * radius;\n  const offset = circumference - (percentage / 100) * circumference;\n  const center = size / 2;\n\n  return (\n    <div\n      className=\"relative inline-flex items-center justify-center\"\n      style={{ width: size, height: size }}\n    >\n      <svg\n        aria-hidden=\"true\"\n        height={size}\n        viewBox={`0 0 ${size} ${size}`}\n        width={size}\n      >\n        <circle\n          className=\"stroke-muted/30\"\n          cx={center}\n          cy={center}\n          fill=\"none\"\n          r={radius}\n          strokeWidth={strokeWidth}\n        />\n        <motion.circle\n          animate={{ strokeDashoffset: offset }}\n          cx={center}\n          cy={center}\n          fill=\"none\"\n          initial={{ strokeDashoffset: circumference }}\n          r={radius}\n          stroke={color}\n          strokeDasharray={circumference}\n          strokeLinecap=\"round\"\n          strokeWidth={strokeWidth}\n          style={{ rotate: \"-90deg\", transformOrigin: \"center\" }}\n          transition={{ type: \"spring\", stiffness: 120, damping: 20 }}\n        />\n      </svg>\n      <span className=\"pointer-events-none absolute inset-0 flex items-center justify-center font-semibold text-[10px] tabular-nums\">\n        {percentage}%\n      </span>\n    </div>\n  );\n}\n\nexport function MilestoneDashboardTimeline({\n  milestones,\n  className,\n}: MilestoneDashboardTimelineProps) {\n  const [activeId, setActiveId] = useState<string | null>(null);\n  const [sweepId, setSweepId] = useState<string | null>(null);\n\n  const totalItems = milestones.reduce((s, m) => s + m.progress.total, 0);\n  const totalCompleted = milestones.reduce(\n    (s, m) => s + m.progress.completed,\n    0\n  );\n  const totalInProgress = milestones.reduce(\n    (s, m) => s + m.progress.inProgress,\n    0\n  );\n  const overallPct = Math.round(\n    (totalCompleted / Math.max(totalItems, 1)) * 100\n  );\n\n  const handleClick = (id: string) => {\n    setSweepId(id);\n    setActiveId((prev) => (prev === id ? null : id));\n    setTimeout(() => setSweepId(null), 500);\n  };\n\n  return (\n    <div className={cn(\"w-full space-y-3\", className)}>\n      {/* KPI bar */}\n      <div className=\"flex items-center gap-3 rounded-xl bg-secondary p-2.5\">\n        <ProgressRing\n          color=\"var(--color-primary)\"\n          percentage={overallPct}\n          size={32}\n          strokeWidth={2.5}\n        />\n        <div className=\"flex flex-1 items-center gap-4 text-[11px]\">\n          <div>\n            <span className=\"font-bold text-sm tabular-nums\">\n              {totalCompleted}\n            </span>\n            <span className=\"text-muted-foreground\">/{totalItems}</span>\n          </div>\n          <div className=\"flex items-center gap-1\">\n            <div className=\"h-1.5 w-1.5 rounded-full bg-emerald-500\" />\n            <span className=\"text-muted-foreground\">{totalCompleted} done</span>\n          </div>\n          <div className=\"flex items-center gap-1\">\n            <div className=\"h-1.5 w-1.5 rounded-full bg-primary\" />\n            <span className=\"text-muted-foreground\">{totalInProgress} WIP</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Timeline */}\n      <div className=\"relative pl-5\">\n        <div className=\"absolute top-0 bottom-0 left-[11.5px] w-px bg-border\" />\n        {milestones.map((m) => {\n          const isActive = activeId === m.id;\n          const isSweeping = sweepId === m.id;\n          return (\n            <div className=\"relative mb-1 last:mb-0\" key={m.id}>\n              <div\n                className=\"absolute top-2.5 -left-3 h-2 w-2 rounded-full border-2 border-background\"\n                style={{ backgroundColor: m.colorHex }}\n              />\n              <button\n                className={cn(\n                  \"relative w-full overflow-hidden rounded-lg p-2 text-left transition-all\",\n                  isActive ? \"bg-accent/50\" : \"hover:bg-accent/20\"\n                )}\n                onClick={() => handleClick(m.id)}\n                type=\"button\"\n              >\n                <AnimatePresence>\n                  {isSweeping && (\n                    <motion.div\n                      animate={{ x: \"100%\", opacity: 0 }}\n                      className=\"absolute inset-0\"\n                      exit={{ opacity: 0 }}\n                      initial={{ x: \"-100%\", opacity: 0.12 }}\n                      style={{ backgroundColor: m.colorHex }}\n                      transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    />\n                  )}\n                </AnimatePresence>\n                <div className=\"relative z-10 flex items-center gap-2\">\n                  <span className=\"text-xs\">{m.emoji}</span>\n                  <span className=\"flex-1 truncate font-medium text-xs\">\n                    {m.name}\n                  </span>\n                  <span className=\"rounded bg-muted px-1 py-0.5 text-[9px]\">\n                    {m.horizonShort}\n                  </span>\n                  <MultiSegmentBar\n                    completed={m.progress.completed}\n                    inProgress={m.progress.inProgress}\n                    total={m.progress.total}\n                  />\n                  <span\n                    className=\"w-6 text-right font-mono text-[10px] tabular-nums\"\n                    style={{ color: m.colorHex }}\n                  >\n                    {m.progress.percentage}%\n                  </span>\n                </div>\n              </button>\n              <AnimatePresence>\n                {isActive && (\n                  <motion.div\n                    animate={{ height: \"auto\", opacity: 1 }}\n                    className=\"overflow-hidden\"\n                    exit={{ height: 0, opacity: 0 }}\n                    initial={{ height: 0, opacity: 0 }}\n                    transition={{\n                      type: \"spring\",\n                      damping: 25,\n                      stiffness: 300,\n                    }}\n                  >\n                    <div className=\"mt-1 ml-5 rounded-lg border bg-card p-2 text-muted-foreground text-xs\">\n                      {m.progress.completed}/{m.progress.total} done &middot;{\" \"}\n                      {m.progress.inProgress} in progress\n                    </div>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n",
      "type": "registry:ui",
      "target": "components/ui/milestone-dashboard-timeline.tsx"
    }
  ],
  "meta": {
    "importSpecifier": "@/components/ui/milestone-dashboard-timeline"
  }
}